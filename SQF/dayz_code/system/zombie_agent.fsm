/*%FSM<COMPILE "C:\Program Files (x86)\Bohemia Interactive\Tools\FSM Editor Personal Edition\scriptedFSM.cfg, DayZ Zombie Agent">*/
/*%FSM<HEAD>*/
/*
item0[] = {"init",0,250,-75.000000,-250.000000,25.000000,-200.000000,0.000000,"init"};
item1[] = {"End",1,250,175.000000,-250.000000,275.000000,-200.000000,0.000000,"End"};
item2[] = {"wait",4,218,-75.000000,0.000000,25.000000,50.000000,0.000000,"wait"};
item3[] = {"Looking_for_Targ",2,250,-75.000000,75.000000,25.000000,125.000000,0.000000,"Looking for" \n "Target"};
item4[] = {"Not_Alive",4,218,0.000000,325.000000,100.000000,375.000000,5.000000,"Not" \n "Alive"};
item5[] = {"Nobody_Near",4,218,0.000000,575.000000,100.000000,625.000000,4.000000,"Nobody" \n "Near"};
item6[] = {"loiter",4,218,-325.000000,0.000000,-225.000000,50.000000,0.000000,"loiter"};
item7[] = {"Loiter",2,250,-325.000000,75.000000,-225.000000,125.000000,0.000000,"Loiter"};
item8[] = {"moveToCompleted",4,218,-200.000000,75.000000,-100.000000,125.000000,1.000000,"moveToCompleted "};
item9[] = {"",7,210,-29.000042,346.000000,-20.999958,354.000000,0.000000,""};
item10[] = {"",7,210,-29.000042,595.999939,-20.999958,604.000061,0.000000,""};
item11[] = {"true",8,218,-75.000000,-175.000000,25.000000,-125.000000,0.000000,"true"};
item12[] = {"Begin",2,250,-75.000000,-100.000000,25.000000,-50.000000,0.000000,"Begin"};
item13[] = {"",7,210,-29.000006,-29.000004,-20.999996,-20.999996,0.000000,""};
item14[] = {"",7,210,-279.000061,-29.000004,-270.999969,-20.999996,0.000000,""};
item15[] = {"",7,210,-254.000046,146.000000,-245.999954,154.000000,0.000000,""};
item16[] = {"Has_Target",4,218,-150.000000,200.000000,-50.000000,250.000000,1.000000,"Has" \n "Target"};
item17[] = {"Chase",2,250,-150.000000,325.000000,-50.000000,375.000000,0.000000,"Chase"};
item18[] = {"Time_Check",4,218,50.000000,75.000000,150.000000,125.000000,0.000000,"Time" \n "Check"};
item19[] = {"",7,210,-29.000006,146.000000,-20.999996,154.000000,0.000000,""};
item20[] = {"",7,210,-29.000006,171.000000,-20.999996,179.000000,0.000000,""};
item21[] = {"",7,210,-104.000008,171.000000,-95.999992,179.000000,0.000000,""};
item22[] = {"Time_Check",4,218,-450.000000,75.000000,-350.000000,125.000000,0.000000,"Time" \n "Check"};
item23[] = {"No_Target",4,218,-250.000000,600.000000,-150.000000,650.000000,3.000000,"No" \n "Target"};
item24[] = {"",7,210,-504.000000,621.000000,-496.000000,629.000000,0.000000,""};
item25[] = {"",7,210,-504.000000,146.000000,-496.000000,154.000000,0.000000,""};
item26[] = {"",7,210,221.000000,346.000000,229.000000,354.000000,0.000000,""};
item27[] = {"",7,210,221.000000,596.000000,229.000000,604.000000,0.000000,""};
item28[] = {"Cleanup_",2,250,175.000000,200.000000,275.000000,250.000000,0.000000,"Cleanup?"};
item29[] = {"nobody_around",4,218,175.000000,-25.000000,275.000000,25.000000,0.000000,"nobody" \n "around"};
item30[] = {"",7,210,-104.000023,621.000000,-95.999985,629.000000,0.000000,""};
item31[] = {"cant_see",4,218,-150.000000,650.000000,-50.000000,700.000000,2.000000,"cant" \n "see"};
item32[] = {"Finish_Move",2,250,-150.000000,725.000000,-50.000000,775.000000,0.000000,"Finish" \n "Move"};
item33[] = {"finished",4,4314,-425.000000,725.000000,-325.000000,775.000000,1.000000,"finished"};
item34[] = {"",7,210,-504.000000,746.000000,-496.000000,754.000000,0.000000,""};
item35[] = {"",7,210,-29.000002,746.000000,-20.999998,754.000000,0.000000,""};
item36[] = {"",7,210,-304.000000,146.000000,-296.000000,154.000000,0.000000,""};
item37[] = {"someone_here",4,218,300.000000,200.000000,400.000000,250.000000,0.000000,"someone" \n "here"};
item38[] = {"wait",2,250,300.000000,125.000000,400.000000,175.000000,0.000000,"wait"};
item39[] = {"time_up",4,218,300.000000,-25.000000,400.000000,25.000000,0.000000,"time" \n "up"};
item40[] = {"",7,210,346.000000,95.999992,354.000000,104.000000,0.000000,""};
item41[] = {"",7,210,221.000000,96.000008,229.000000,103.999977,0.000000,""};
item42[] = {"Time_Check",4,218,425.000000,125.000000,525.000000,175.000000,0.000000,"Time" \n "Check"};
item43[] = {"",7,210,346.000000,-79.000000,354.000000,-71.000000,0.000000,""};
item44[] = {"",7,210,221.000000,-79.000000,229.000000,-71.000000,0.000000,""};
item45[] = {"too_long",4,218,-425.000000,875.000000,-325.000000,925.000000,0.000000,"too long"};
item46[] = {"",7,210,-229.000000,896.000000,-221.000000,904.000000,0.000000,""};
item47[] = {"",7,210,-504.000000,896.000000,-496.000000,904.000000,0.000000,""};
item48[] = {"Reset_Targeting",2,250,-550.000000,525.000000,-450.000000,575.000000,0.000000,"Reset" \n "Targeting"};
item49[] = {"true",8,218,-550.000000,250.000000,-450.000000,300.000000,0.000000,"true"};
item50[] = {"deleted",4,218,425.000000,-25.000000,525.000000,25.000000,0.000000,"deleted"};
item51[] = {"",7,210,471.000000,-79.000000,479.000000,-71.000000,0.000000,""};
item52[] = {"",7,210,471.000000,95.999977,479.000000,104.000023,0.000000,""};
item53[] = {"",7,210,-229.000000,746.000000,-220.999985,754.000000,0.000000,""};
item54[] = {"player_check",4,218,-450.000000,0.000000,-350.000000,50.000000,0.000000,"player" \n "check"};
item55[] = {"player_check",4,218,50.000000,0.000000,150.000000,50.000000,0.000000,"player" \n "check"};
item56[] = {"is_Dedicated",4,218,50.000000,-250.000000,150.000000,-200.000000,5.000000,"is" \n "Dedicated"};
item57[] = {"Failed_to_move",4,218,-200.000000,0.000000,-100.000000,50.000000,2.000000,"Failed to move"};
item58[] = {"Check_Los",4,218,-425.000000,775.000000,-325.000000,825.000000,2.000000,"Check Los"};
item59[] = {"",7,210,-229.000000,846.000000,-221.000000,854.000000,0.000000,""};
item60[] = {"",7,210,-229.000000,796.000000,-221.000000,804.000000,0.000000,""};
item61[] = {"",7,210,-229.000000,846.000000,-221.000000,854.000000,0.000000,""};
item62[] = {"",7,210,-504.000000,796.000000,-496.000000,804.000000,0.000000,""};
item63[] = {"",7,210,-504.000000,846.000000,-496.000000,854.000000,0.000000,""};
item64[] = {"Time_Check",4,218,-25.000000,250.000000,75.000000,300.000000,0.000000,"Time" \n "Check"};
item65[] = {"Time_Check",4,218,-150.000000,800.000000,-50.000000,850.000000,0.000000,"Time" \n "Check"};
item66[] = {"",7,210,-504.000000,671.000000,-496.000000,679.000000,0.000000,""};
item67[] = {"",7,210,-304.000000,621.000000,-296.000000,629.000000,0.000000,""};
item68[] = {"",7,210,-29.000044,471.000000,-20.999956,479.000000,0.000000,""};
item69[] = {"Chasing",4,218,-250.000000,250.000000,-150.000000,300.000000,0.000000,"Chasing"};
item70[] = {"Target_Alive",4,218,-300.000000,325.000000,-200.000000,375.000000,0.000000,"Target Alive"};
item71[] = {"Attacking",4,218,-250.000000,400.000000,-150.000000,450.000000,0.000000,"Attacking"};
item72[] = {"____FAKE____",9,2880,0.000000,0.000000,0.000000,0.000000,0.000000,"____FAKE____"};
link0[] = {0,11};
link1[] = {0,56};
link2[] = {2,3};
link3[] = {3,18};
link4[] = {3,19};
link5[] = {3,55};
link6[] = {4,26};
link7[] = {5,27};
link8[] = {6,7};
link9[] = {7,8};
link10[] = {7,15};
link11[] = {7,22};
link12[] = {7,54};
link13[] = {7,57};
link14[] = {8,7};
link15[] = {9,4};
link16[] = {9,68};
link17[] = {10,5};
link18[] = {11,12};
link19[] = {12,13};
link20[] = {13,2};
link21[] = {13,14};
link22[] = {14,6};
link23[] = {15,19};
link24[] = {16,17};
link25[] = {17,9};
link26[] = {17,30};
link27[] = {17,64};
link28[] = {17,69};
link29[] = {17,70};
link30[] = {17,71};
link31[] = {18,3};
link32[] = {19,20};
link33[] = {20,9};
link34[] = {20,21};
link35[] = {21,16};
link36[] = {22,7};
link37[] = {23,67};
link38[] = {24,48};
link39[] = {25,36};
link40[] = {26,28};
link41[] = {27,26};
link42[] = {28,37};
link43[] = {28,41};
link44[] = {29,44};
link45[] = {30,23};
link46[] = {30,31};
link47[] = {31,32};
link48[] = {32,35};
link49[] = {32,53};
link50[] = {32,65};
link51[] = {33,34};
link52[] = {34,66};
link53[] = {35,10};
link54[] = {36,7};
link55[] = {37,38};
link56[] = {38,40};
link57[] = {38,42};
link58[] = {39,43};
link59[] = {40,39};
link60[] = {40,41};
link61[] = {40,52};
link62[] = {41,29};
link63[] = {42,38};
link64[] = {43,44};
link65[] = {44,1};
link66[] = {45,47};
link67[] = {46,45};
link68[] = {47,63};
link69[] = {48,49};
link70[] = {49,25};
link71[] = {50,51};
link72[] = {51,43};
link73[] = {52,50};
link74[] = {53,33};
link75[] = {53,60};
link76[] = {54,7};
link77[] = {55,3};
link78[] = {56,1};
link79[] = {57,7};
link80[] = {58,62};
link81[] = {59,46};
link82[] = {60,58};
link83[] = {60,61};
link84[] = {62,34};
link85[] = {63,62};
link86[] = {64,17};
link87[] = {65,32};
link88[] = {66,24};
link89[] = {67,24};
link90[] = {68,10};
link91[] = {69,17};
link92[] = {70,48};
link93[] = {71,17};
link94[] = {72,45};
globals[] = {25.000000,1,0,0,0,640,480,1,143,6316128,1,-648.421997,603.837463,1018.758118,216.205017,1448,928,1};
window[] = {0,-1,-1,-1,-1,1073,3,1919,0,1,1466};
*//*%FSM</HEAD>*/
class FSM
{
  fsmName = "DayZ Zombie Agent";
  class States
  {
    /*%FSM<STATE "init">*/
    class init
    {
      name = "init";
      init = /*%FSM<STATEINIT""">*/"_position = 	_this select 0;" \n
       "_agent = 		_this select 1;" \n
       "_secondHand = false;" \n
       "_stack = [];" \n
       "_stackcount = 0;" \n
       "_targetPos = [];" \n
       "_stackItem = [];" \n
       "_agroRating = 0;" \n
       "if (count _this > 2) then {" \n
       "	_secondHand = true;" \n
       "	diag_log (""Second Hand Zombie Initialized: "" + str(_this));" \n
       "};"/*%FSM</STATEINIT""">*/;
      precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
      class Links
      {
        /*%FSM<LINK "is_Dedicated">*/
        class is_Dedicated
        {
          priority = 5.000000;
          to="End";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"isDedicated"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
        /*%FSM<LINK "true">*/
        class true
        {
          priority = 0.000000;
          to="Begin";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"dayz_clientPreload and !(isNull _agent)"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
      };
    };
    /*%FSM</STATE>*/
    /*%FSM<STATE "End">*/
    class End
    {
      name = "End";
      init = /*%FSM<STATEINIT""">*/"if (!isDedicated) then {" \n
       "	if (!isNull _agent) then {" \n
       "		deleteVehicle _agent;" \n
       "	};" \n
       "} else {" \n
       "	[_agent] call zombie_findOwner;" \n
       "};"/*%FSM</STATEINIT""">*/;
      precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
      class Links
      {
      };
    };
    /*%FSM</STATE>*/
    /*%FSM<STATE "Looking_for_Targ">*/
    class Looking_for_Targ
    {
      name = "Looking_for_Targ";
      init = /*%FSM<STATEINIT""">*/"_isAlive = alive _agent;" \n
       "_target = _agent call zombie_findTargetAgent;" \n
       "_timeN = diag_tickTime;" \n
       "" \n
       "" \n
       "_newDest = _agent getVariable [""myDest"",getposATL _agent];" \n
       "if (!isNil ""_newDest"") then {" \n
       "	if (_newDest distance _myDest > 0) then {" \n
       "		_myDest = _newDest;" \n
       "		_agent moveTo _myDest;" \n
       "		_agent forceSpeed 2;" \n
       "	};" \n
       "};" \n
       "" \n
       "//diag_log (""Zombie "" + str(_agent) + "" Wait "");"/*%FSM</STATEINIT""">*/;
      precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
      class Links
      {
        /*%FSM<LINK "Not_Alive">*/
        class Not_Alive
        {
          priority = 5.000000;
          to="Cleanup_";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"!_isAlive"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/"dayz_agroSpawnZombies = dayz_agroSpawnZombies - 1;"/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
        /*%FSM<LINK "Nobody_Near">*/
        class Nobody_Near
        {
          priority = 4.000000;
          to="Cleanup_";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"!_isSomeone"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
        /*%FSM<LINK "Has_Target">*/
        class Has_Target
        {
          priority = 1.000000;
          to="Chase";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"!(isNull _target)"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/"//Leader cries out" \n
           "if (_isSomeone) then {" \n
           "	[_agent,""spotted"",0,false] call dayz_zombieSpeak;" \n
           "};" \n
           "if (!_hasMoved) then {" \n
           "	_agent setVariable[""doLoiter"",true];" \n
           "};" \n
           "_countr = 0;" \n
           "_losCheck = 0;" \n
           "_cantSee = false;"/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
        /*%FSM<LINK "player_check">*/
        class player_check
        {
          priority = 0.000000;
          to="Looking_for_Targ";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"(diag_tickTime - _entityTime) > 30"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/"_entityTime = diag_tickTime;" \n
           "" \n
           "_list = (getposATL _agent) nearEntities [[""CAManBase"",""AllVehicles""],300];" \n
           "_isSomeone = ({isPlayer _x} count _list) > 0;"/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
        /*%FSM<LINK "Time_Check">*/
        class Time_Check
        {
          priority = 0.000000;
          to="Looking_for_Targ";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"(diag_tickTime - _timeN) > 1"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
      };
    };
    /*%FSM</STATE>*/
    /*%FSM<STATE "Loiter">*/
    class Loiter
    {
      name = "Loiter";
      init = /*%FSM<STATEINIT""">*/"_isAlive = alive _agent;" \n
       "_target = _agent call zombie_findTargetAgent;" \n
       "" \n
       "_agent forceSpeed 2;" \n
       "" \n
       "" \n
       "_newDest = _agent getVariable [""myDest"",getposATL _agent];" \n
       "if (!isNil ""_newDest"") then {" \n
       "	if (_newDest distance _myDest > 0) then {" \n
       "		_myDest = _newDest;" \n
       "		_agent moveTo _myDest;" \n
       "		_agent forceSpeed 2;" \n
       "	};" \n
       "};" \n
       "" \n
       "_timeN = diag_tickTime;" \n
       "" \n
       "//hintSilent (""loitering..."" + str(_agent distance (_agent getVariable [""myDest"",getposATL _agent])));" \n
       "" \n
       "if (_secondHand) then {" \n
       "	diag_log (""Zombie "" + str(_agent) + "" Loiter "" + "" distance: "" + str(_newDest distance _myDest));" \n
       "	_agent doMove (getPosATL player);" \n
       "	_agent moveTo (getPosATL player);" \n
       "};"/*%FSM</STATEINIT""">*/;
      precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
      class Links
      {
        /*%FSM<LINK "Not_Alive">*/
        class Not_Alive
        {
          priority = 5.000000;
          to="Cleanup_";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"!_isAlive"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/"dayz_agroSpawnZombies = dayz_agroSpawnZombies - 1;"/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
        /*%FSM<LINK "Nobody_Near">*/
        class Nobody_Near
        {
          priority = 4.000000;
          to="Cleanup_";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"!_isSomeone"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
        /*%FSM<LINK "Failed_to_move">*/
        class Failed_to_move
        {
          priority = 2.000000;
          to="Loiter";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"moveToFailed _agent;"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/"" \n
           "[_agent,_position] call zombie_loiter;" \n
           "_myDest = _agent getVariable [""myDest"",getposATL _agent];" \n
           ""/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
        /*%FSM<LINK "Has_Target">*/
        class Has_Target
        {
          priority = 1.000000;
          to="Chase";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"!(isNull _target)"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/"//Leader cries out" \n
           "if (_isSomeone) then {" \n
           "	[_agent,""spotted"",0,false] call dayz_zombieSpeak;" \n
           "};" \n
           "if (!_hasMoved) then {" \n
           "	_agent setVariable[""doLoiter"",true];" \n
           "};" \n
           "_countr = 0;" \n
           "_losCheck = 0;" \n
           "_cantSee = false;"/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
        /*%FSM<LINK "moveToCompleted">*/
        class moveToCompleted
        {
          priority = 1.000000;
          to="Loiter";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"moveToCompleted _agent;" \n
           "//_agent distance (_agent getVariable [""myDest"",getposATL _agent]) < 3"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/"[_agent,_position] call zombie_loiter;" \n
           "_myDest = _agent getVariable [""myDest"",getposATL _agent];" \n
           ""/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
        /*%FSM<LINK "player_check">*/
        class player_check
        {
          priority = 0.000000;
          to="Loiter";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"(diag_tickTime - _entityTime) > 30"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/"_entityTime = time;" \n
           "" \n
           "_list = (getposATL _agent) nearEntities [[""CAManBase"",""AllVehicles""],300];" \n
           "_isSomeone = ({isPlayer _x} count _list) > 0;"/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
        /*%FSM<LINK "Time_Check">*/
        class Time_Check
        {
          priority = 0.000000;
          to="Loiter";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"(diag_tickTime - _timeN) > 1"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
      };
    };
    /*%FSM</STATE>*/
    /*%FSM<STATE "Begin">*/
    class Begin
    {
      name = "Begin";
      init = /*%FSM<STATEINIT""">*/"_doLoiter = 	_agent getVariable[""doLoiter"",true];" \n
       "" \n
       "_myDest = 	_position;" \n
       "_newDest = 	_position;" \n
       "_array = 		[];" \n
       "" \n
       "_bodyStay = 	60;" \n
       "" \n
       "_hasMoved = _doLoiter;" \n
       "" \n
       "_agent disableAI ""FSM"";" \n
       "_newDest = getPosATL _agent;" \n
       "_timeN = time;" \n
       "" \n
       " _id = _agent addeventhandler [""HandleDamage"",{_this call local_zombieDamage}];" \n
       "" \n
       "//hint ""run local zombie"";" \n
       "_isSomeone = true;" \n
       "" \n
       "_target = objNull;" \n
       "_targetPos = [];" \n
       "_countr = 0;" \n
       "" \n
       "//Spawn roaming script (individual to unit)" \n
       "_entityTime = diag_tickTime;" \n
       "" \n
       "//Debug" \n
       "if (_secondHand) then {" \n
       "	diag_log (""Zombie Brain Initialized "" + str(_agent) + "" doLoiter: "" + str(_doLoiter));" \n
       "	[_agent,_position] call zombie_loiter;" \n
       "	_myDest = _agent getVariable [""myDest"",getposATL _agent];" \n
       "" \n
       "};" \n
       ""/*%FSM</STATEINIT""">*/;
      precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
      class Links
      {
        /*%FSM<LINK "loiter">*/
        class loiter
        {
          priority = 0.000000;
          to="Loiter";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"_hasMoved"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
        /*%FSM<LINK "wait">*/
        class wait
        {
          priority = 0.000000;
          to="Looking_for_Targ";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"!_hasMoved"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
      };
    };
    /*%FSM</STATE>*/
    /*%FSM<STATE "Chase">*/
    class Chase
    {
      name = "Chase";
      init = /*%FSM<STATEINIT""">*/"_timeN = diag_tickTime;" \n
       "" \n
       "if (speed _agent < 0.1) then {_countr = _countr + 1} else {_countr = 0};" \n
       "" \n
       "_targetPosition = getPosATL _target;" \n
       "_agentPosition = getPosATL _agent;" \n
       "" \n
       "_list = (_agentPosition) nearEntities [[""Man""],75];" \n
       "_playerPosition = [];" \n
       "_isAlive = alive _agent;" \n
       "_isAliveTarget = alive _target;" \n
       "_targetdistance = _agent distance _target;" \n
       "_r = 5;" \n
       "_playerdistance = 0;" \n
       "" \n
       "{" \n
       "	if (isPlayer _x) then {" \n
       "		if ( _target != _x) then {" \n
       "			_playerNewAggroRank = _x getVariable [""aggroRank"",0];" \n
       "			_playerOldAggroRank = _target getVariable [""aggroRank"",0];" \n
       "			if (_playerNewAggroRank >= _playerOldAggroRank) then {" \n
       "				_playerPosition = getPosATL _x;" \n
       "				_playerdistance = _agent distance _x;" \n
       "" \n
       "				if (_playerdistance <= _targetdistance) then " \n
       "				{" \n
       "					_target = _x;" \n
       "					_targetPosition = _playerPosition;" \n
       "					diag_log(str(_agent) + "" found a new target "" + str(_x) + "" and is avoiding "" + str(_target));" \n
       "				};" \n
       "			};" \n
       "		};" \n
       "	};" \n
       "} foreach _list;" \n
       "" \n
       "switch (true) do {" \n
       "" \n
       "	case (_agent distance _target < 5) :" \n
       "	{" \n
       "		_r = 2;" \n
       "		diag_log(""Setting movement distance to 2"");" \n
       "	};" \n
       "	case ((_agent distance _target > 6) && (_agent distance _target < 15)) :" \n
       "	{" \n
       "		_r = 5;" \n
       "		diag_log(""Setting movement distance to 5"");" \n
       "	};" \n
       "	case ((_agent distance _target > 16) && (_agent distance _target < 25)) :" \n
       "	{" \n
       "		_r = 8;" \n
       "		diag_log(""Setting movement distance to 8"");" \n
       "	};" \n
       "	case (_agent distance _target > 26) :" \n
       "	{" \n
       "		_r = 10;" \n
       "		diag_log(""Setting movement distance to 10"");" \n
       "	};" \n
       "	default" \n
       "	{" \n
       "		_r = 5;" \n
       "		diag_log(""Setting movement distance to 5"");" \n
       "	};" \n
       "};" \n
       "" \n
       "" \n
       "//_rtemp1 = (( _target distance _agent ) / 2) max 0.5;" \n
       "//_r = ceil(( _target distance _agent ) / 2);" \n
       "//diag_log(""current r: "" + str(_r) + "" 1: "" + str(_rtemp1) + "" 2: "" + str(_rtemp2));" \n
       "" \n
       "_xt = _targetPosition select 0;" \n
       "_yt = _targetPosition select 1;" \n
       "_xa = _agentPosition select 0;" \n
       "_ya = _agentPosition select 1;" \n
       "_dx = _xa - _xt;" \n
       "_dy = _ya - _yt;" \n
       "_dir = _dy atan2 _dx;" \n
       "_dx = _dx - _r * cos _dir;" \n
       "_dy = _dy - _r * sin _dir;" \n
       "_targetPos = [_xt + _dx, _yt + _dy, 0];" \n
       "_agent moveTo _targetPos;" \n
       "" \n
       "" \n
       "//Check if LOS" \n
       "if (_losCheck == 6) then {" \n
       "	_losCheck = 0;" \n
       "	_cantSee = [_agent,_target] call dayz_losCheck;" \n
       "};" \n
       ""/*%FSM</STATEINIT""">*/;
      precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
      class Links
      {
        /*%FSM<LINK "Not_Alive">*/
        class Not_Alive
        {
          priority = 5.000000;
          to="Cleanup_";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"!_isAlive"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/"dayz_agroSpawnZombies = dayz_agroSpawnZombies - 1;"/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
        /*%FSM<LINK "Nobody_Near">*/
        class Nobody_Near
        {
          priority = 4.000000;
          to="Cleanup_";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"!_isSomeone"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
        /*%FSM<LINK "No_Target">*/
        class No_Target
        {
          priority = 3.000000;
          to="Reset_Targeting";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"(isNull _target)"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/"// reset stance to favorite one" \n
           "_agent setUnitPos (_agent getVariable [""stance"", ""UP""]);" \n
           "diag_log (str(_agent) + "" has no target"");"/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
        /*%FSM<LINK "cant_see">*/
        class cant_see
        {
          priority = 2.000000;
          to="Finish_Move";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"_cantSee"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/"" \n
           "//update every second?" \n
           "_r = ceil(( _target distance _agent ) / 2);" \n
           "_targetPosition = getPosATL _target;" \n
           "_agentPosition = getPosATL _agent;" \n
           "_xt = _targetPosition select 0;" \n
           "_yt = _targetPosition select 1;" \n
           "_xa = _agentPosition select 0;" \n
           "_ya = _agentPosition select 1;" \n
           "_dx = _xa - _xt;" \n
           "_dy = _ya - _yt;" \n
           "_dir = _dy atan2 _dx;" \n
           "_dx = _dx - _r * cos _dir;" \n
           "_dy = _dy - _r * sin _dir;" \n
           "_targetPos = [_xt + _dx, _yt + _dy, 0];" \n
           "_agent moveTo _targetPos;" \n
           "" \n
           "" \n
           "diag_log (""ZFSM: Cant See Target"");"/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
        /*%FSM<LINK "Attacking">*/
        class Attacking
        {
          priority = 0.000000;
          to="Chase";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"_agent distance _target < 2.2"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/"//diag_log (str(_agent) + "" has target and farther then 2.2"");" \n
           "" \n
           "_agent forceSpeed 4;"/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
        /*%FSM<LINK "Target_Alive">*/
        class Target_Alive
        {
          priority = 0.000000;
          to="Reset_Targeting";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"!_isAliveTarget"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
        /*%FSM<LINK "Chasing">*/
        class Chasing
        {
          priority = 0.000000;
          to="Chase";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"_agent distance _target > 2.2"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/"//diag_log (str(_agent) + "" has target and farther then 2.2"");" \n
           "" \n
           "_agent forceSpeed 6;"/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
        /*%FSM<LINK "Time_Check">*/
        class Time_Check
        {
          priority = 0.000000;
          to="Chase";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"(diag_tickTime - _timeN) > 0.2"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/"//Count los checks" \n
           "_losCheck = _losCheck + 1;" \n
           "" \n
           "" \n
           "//diag_log (""Time Check"");"/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
      };
    };
    /*%FSM</STATE>*/
    /*%FSM<STATE "Cleanup_">*/
    class Cleanup_
    {
      name = "Cleanup_";
      init = /*%FSM<STATEINIT""">*/"_waitStart = diag_tickTime;" \n
       "" \n
       "_list = (getposATL _agent) nearEntities [[""CAManBase"",""AllVehicles""],300];" \n
       "_isSomeone = ({isPlayer _x} count _list) > 0;"/*%FSM</STATEINIT""">*/;
      precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
      class Links
      {
        /*%FSM<LINK "nobody_around">*/
        class nobody_around
        {
          priority = 0.000000;
          to="End";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"!_isSomeone"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/"dayz_spawnZombies = dayz_spawnZombies - 1;"/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
        /*%FSM<LINK "someone_here">*/
        class someone_here
        {
          priority = 0.000000;
          to="wait";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"_isSomeone"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
      };
    };
    /*%FSM</STATE>*/
    /*%FSM<STATE "Finish_Move">*/
    class Finish_Move
    {
      name = "Finish_Move";
      init = /*%FSM<STATEINIT""">*/"_timeN = diag_tickTime;" \n
       "" \n
       "_list = (getposATL _agent) nearEntities [[""CAManBase"",""AllVehicles""],300];" \n
       "_isSomeone = ({isPlayer _x} count _list) > 0;" \n
       "" \n
       "" \n
       "//recheck los while you move to location" \n
       "if (_losCheck == 3) then {" \n
       "	_losCheck = 0;" \n
       "	_cantSee = [_agent,_target] call dayz_losCheck;" \n
       "};" \n
       "" \n
       ""/*%FSM</STATEINIT""">*/;
      precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
      class Links
      {
        /*%FSM<LINK "Nobody_Near">*/
        class Nobody_Near
        {
          priority = 4.000000;
          to="Cleanup_";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"!_isSomeone"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
        /*%FSM<LINK "Check_Los">*/
        class Check_Los
        {
          priority = 2.000000;
          to="Reset_Targeting";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"!_cantSee"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/"//Move to target" \n
           "" \n
           "_r = ceil(( _target distance _agent ) / 2);" \n
           "_targetPosition = getPosATL _target;" \n
           "_agentPosition = getPosATL _agent;" \n
           "_xt = _targetPosition select 0;" \n
           "_yt = _targetPosition select 1;" \n
           "_xa = _agentPosition select 0;" \n
           "_ya = _agentPosition select 1;" \n
           "_dx = _xa - _xt;" \n
           "_dy = _ya - _yt;" \n
           "_dir = _dy atan2 _dx;" \n
           "_dx = _dx - _r * cos _dir;" \n
           "_dy = _dy - _r * sin _dir;" \n
           "_targetPos = [_xt + _dx, _yt + _dy, 0];" \n
           "_agent moveTo _targetPos;" \n
           "" \n
           "diag_log (""ZFSM: Check LOS"");"/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
        /*%FSM<LINK "finished">*/
        class finished
        {
          priority = 1.000000;
          to="Reset_Targeting";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"_agent distance _targetPos <=  3"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/"diag_log (""ZFSM: Finished"");"/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
        /*%FSM<LINK "Time_Check">*/
        class Time_Check
        {
          priority = 0.000000;
          to="Finish_Move";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"(diag_tickTime - _timeN) > 2"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/"//Count los checks" \n
           "_losCheck = _losCheck + 1;" \n
           "" \n
           "diag_log (""ZFSM: Finish Move Time Check"");"/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
      };
    };
    /*%FSM</STATE>*/
    /*%FSM<STATE "wait">*/
    class wait
    {
      name = "wait";
      init = /*%FSM<STATEINIT""">*/"_list = (getposATL _agent) nearEntities [[""CAManBase"",""AllVehicles""],300];" \n
       "_isSomeone = ({isPlayer _x} count _list) > 0;" \n
       "" \n
       "_timeN = diag_tickTime;"/*%FSM</STATEINIT""">*/;
      precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
      class Links
      {
        /*%FSM<LINK "time_up">*/
        class time_up
        {
          priority = 0.000000;
          to="End";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"(diag_tickTime - _waitStart) > 300"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
        /*%FSM<LINK "nobody_around">*/
        class nobody_around
        {
          priority = 0.000000;
          to="End";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"!_isSomeone"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/"dayz_spawnZombies = dayz_spawnZombies - 1;"/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
        /*%FSM<LINK "deleted">*/
        class deleted
        {
          priority = 0.000000;
          to="End";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"isNull _agent;"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
        /*%FSM<LINK "Time_Check">*/
        class Time_Check
        {
          priority = 0.000000;
          to="wait";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"(diag_tickTime - _timeN) > 30"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
      };
    };
    /*%FSM</STATE>*/
    /*%FSM<STATE "Reset_Targeting">*/
    class Reset_Targeting
    {
      name = "Reset_Targeting";
      init = /*%FSM<STATEINIT""">*/"_agent setVariable [""targets"",[],true];" \n
       "_target = objNull;" \n
       "" \n
       "diag_log (str(_agent) + "" resetting target"");" \n
       "/*" \n
       "_targetPos = getPosATL _target;" \n
       "_agent setVariable [""myDest"",_targetPos];" \n
       "_agent moveTo _targetPos;" \n
       "*/" \n
       "" \n
       "" \n
       ""/*%FSM</STATEINIT""">*/;
      precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
      class Links
      {
        /*%FSM<LINK "true">*/
        class true
        {
          priority = 0.000000;
          to="Loiter";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"true"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/"//diag_log (""system reset"");"/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
      };
    };
    /*%FSM</STATE>*/
    /*%FSM<STATE "____FAKE____">*/
    class ____FAKE____
    {
      name = "____FAKE____";
      init = /*%FSM<STATEINIT""">*/""/*%FSM</STATEINIT""">*/;
      precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
      class Links
      {
        /*%FSM<LINK "too_long">*/
        class too_long
        {
          priority = 0.000000;
          to="Reset_Targeting";
          precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
          condition=/*%FSM<CONDITION""">*/"(diag_tickTime - _timeN) > 10"/*%FSM</CONDITION""">*/;
          action=/*%FSM<ACTION""">*/"diag_log (""ZFSM: Too long"");"/*%FSM</ACTION""">*/;
        };
        /*%FSM</LINK>*/
      };
    };
    /*%FSM</STATE>*/
  };
  initState="init";
  finalStates[] =
  {
    "End",
  };
};
/*%FSM</COMPILE>*/